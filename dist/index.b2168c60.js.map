{"mappings":"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","sources":["Script/gameObject.js"],"sourcesContent":["class GameObject {\n    constructor(config) {\n        this.id = null\n        this.isAppeared = false\n        this.x = config.x\n        this.y = config.y \n        this.direction = config.direction || 'down'\n        this.behavior = config.behavior\n        this.behaviorLoop = this.checkBehaviorEvent() || []\n        this.behaviorLoopIndex = 0\n        this.isBehave = false\n        this.talking = config.talkingBox || []\n        this.currentStoryFlagsUpdate = playerState.numberFlags\n        \n        this.sprite = new Sprite({\n            gameObject: this,\n            src: config.src || \"\",\n            x: this.x,\n            y: this.y,\n            useShadow: config.useShadow || null\n        })\n    }\n\n    update(state) {\n\n    }\n\n    appear(map) {\n\n        this.isAppeared = true\n        if (this.previousPosition) {\n            this.x = this.previousPosition.x\n            this.y = this.previousPosition.y\n            map.addWalls(this.previousPosition.x, this.previousPosition.y)\n        } else {\n            map.addWalls(this.x, this.y)\n        }\n        this.doBehaviorEvent(map)\n    }\n\n    disappear(map) {\n        this.isAppeared = false\n        map.removeWalls(this.x, this.y)\n        // //Innacesible\n        // this.previousPosition = {\n        //     x: this.x,\n        //     y: this.y\n        // }\n        // this.x = withGrid(100)\n        // this.y = withGrid(100)\n    }\n    \n    draw(ctx, cameraPerson) {\n        this.sprite.draw(ctx, cameraPerson)\n    }\n\n    checkBehaviorEvent() {\n        if (!this.behavior) return\n        let behaviorLoop = utils.checkRequires(this.behavior)\n        return behaviorLoop\n    }\n    async doBehaviorEvent(map) {\n        if (this.behaviorLoop.length === 0 || map.cutscenePlaying || this.isStanding || !this.isAppeared || this.isBehave )  {       \n            return\n        }\n        this.isBehave = true\n\n        const eventConfig = this.behaviorLoop[this.behaviorLoopIndex]\n        eventConfig.who = this.id\n        \n        const eventHandler = new OverworldEvent({map, eventConfig})\n\n        await eventHandler.init();\n       \n        this.behaviorLoopIndex += 1\n        \n        if (this.behaviorLoopIndex === this.behaviorLoop.length) {\n            this.behaviorLoopIndex = 0\n            if (this.currentStoryFlagsUpdate !== playerState.numberFlags) {\n                this.currentStoryFlagsUpdate = playerState.numberFlags\n                this.behaviorLoop = this.checkBehaviorEvent()\n            }\n\n        }\n        this.isBehave = false\n        this.doBehaviorEvent(map)\n\n    }\n}"],"names":[],"version":3,"file":"index.b2168c60.js.map","sourceRoot":"/__parcel_source_root/"}