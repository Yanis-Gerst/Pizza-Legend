{"mappings":"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","sources":["Script/Battle/Combattant.js"],"sourcesContent":["class Combatant {\n    constructor(config, battle) {\n        this.battle = battle \n        this.buff = null;\n        this.debuff = null;\n        this.specialDamage = null;\n        this.recovery = null;\n        this.statusEffects = [\"buff\", \"debuff\", \"specialDamage\", \"recovery\"]\n        Object.keys(config).forEach(key => {\n            // Stat informations\n            this[key] = config[key]\n        })\n        this.notifPizza = new NotifPizza({currentPizza: this})\n        this.notifPizza.updateData()\n        //Mettre le hp = maxHp de base\n        this.hp = typeof(this.hp) === \"undefined\" ? this.maxHp : this.hp\n    \n\n    }\n\n    init(container) {\n        this.createElement()\n        container.appendChild(this.hudElement)\n        container.appendChild(this.pizzaElement)\n        this.update()\n    }\n    \n    get hpPercent() {\n        const percent = this.hp / this.maxHp * 100\n        return percent > 0 ? percent : 0\n    }\n\n    get xpPercent() {\n        return this.xp / this.maxXp * 100\n    }\n\n    get isActive() {\n        return this.battle?.activeCombatants[this.team] === this.id\n    }\n\n    get givesXp() {\n        //Voir un leveling System\n        let bonusLvl = this.level - 1\n        return 100 + 50 * bonusLvl\n    }\n\n\n    createElement() {\n        this.hudElement = document.createElement('div')\n        this.hudElement.classList.add(\"combatant\")\n        this.hudElement.setAttribute(\"data-combatant\", this.id)\n        this.hudElement.setAttribute(\"data-team\", this.team)\n        this.hudElement.innerHTML =  (`\n            <p class=\"combatant-name\">${this.name}</p>\n            <p class=\"combatant-level\">${this.level}</p>\n            <div class=\"combatant-character-container\">\n                <img class=\"combatant-character\" src=\"${this.src}\" alt=\"${this.name}\" />\n            </div>\n            <img class=\"combatant-type\" src=\"${this.icon}\" alt=\"${this.type}\" />\n            <svg viewBox=\"0 0 26 3\" class=\"combatant-life-container\">\n                <rect x=0 y=0 width=\"0%\" height = 1 fill=\"#82ff71\"\" />\n                <rect x=0 y=1 width=\"0%\" height = 2 fill=\"#3ef126\"\" />\n            </svg>\n            <svg viewBox=\"0 0 26 2\" class=\"combatant-xp-container\">\n                <rect x=0 y=0 width=\"0%\" height = 1 fill=\"#ffd76a\"\" />\n                <rect x=0 y=1 width=\"0%\" height = 1 fill=\"#ffc934\"\" />\n            </svg>\n            <div class=\"combatant-status\">\n                <p class=\"combatant-status-buff\"></p>\n                <p class=\"combatant-status-debuff\"></p>\n                <p class=\"combatant-status-specialDamage\"></p>\n                <p class=\"combatant-status-recovery\"></p>\n            </div>\n        `)\n\n        this.pizzaElement = document.createElement('img')\n        this.pizzaElement.classList.add(\"pizza\")\n        this.pizzaElement.setAttribute(\"src\", this.src)\n        this.pizzaElement.setAttribute(\"alt\", this.name)\n        this.pizzaElement.setAttribute(\"data-team\", this.team)\n\n        this.hpFills = this.hudElement.querySelectorAll(\".combatant-life-container > rect\")\n        this.xpFills = this.hudElement.querySelectorAll(\".combatant-xp-container > rect\")\n        this.hudLevel = this.hudElement.querySelector(\".combatant-level\")\n    }\n\n    update(changes = {}) {\n        \n        Object.keys(changes).forEach(key => {\n            this[key] = changes[key]\n        })\n\n        //Independancies Status effect\n        \n\n        this.hudElement.setAttribute(\"data-active\", this.isActive)\n        this.pizzaElement.setAttribute(\"data-active\", this.isActive)\n        this.hudLevel.textContent = this.level\n\n        this.hpFills.forEach(fill => {\n            fill.style.width = `${this.hpPercent}%`\n        })\n        // A Voir pour Faire 1 forEach + perf\n        this.xpFills.forEach(fill => {\n            fill.style.width = `${this.xpPercent}%`\n        }) \n        \n       \n        this.allStatusDisplay()     \n\n    }\n\n    allStatusDisplay() {\n        this.statusEffects.forEach(effect => {\n            this.statusDisplay(effect)\n        })\n    }\n    statusDisplay(propretry) {\n        const statusElement = this.hudElement.querySelector(`.combatant-status-${propretry}`)\n        if (this[propretry]) {\n            statusElement.textContent = this[propretry].name\n            statusElement.style.opacity = 1\n        } else {\n            statusElement.textContent = \"\"\n            statusElement.style.opacity = 0\n        }\n    }\n\n    getPostEvent() {\n\n        if (this.recovery) {\n            return [\n                {type:\"stateChange\", recovery: true, onCaster: true, power:this.recovery.power}\n            ]\n        } else if (this.specialDamage) {\n            return [\n                {type:\"stateChange\", specialDamage: true, onCaster: true, power:this.specialDamage.power}\n            ]\n        }\n\n        return []\n    }\n\n    getBuff() {\n\n        if (this.buff?.name === \"Moment Chaud\") {\n            this.buff.buffAtk = 1 + Math.round(this.buff.caster.attackSpe * this.buff.power) / 100\n        } else if (this.buff?.name === \"AtkSpe +\") {\n            if (this.debuff.buffAtkSpe) return\n            this.buff.buffAtkSpe = 1 + Math.round(this.buff.caster.attackSpe * this.buff.power) / 100\n        } else if (this.debuff?.name === \"Atk -\") {\n            // Pourcentage\n            this.debuff.debuffAtk = 1 - Math.round(this.debuff.caster.attackSpe * this.debuff.power) / 100\n        } else if (this.debuff?.name === \"AtkSpe -\") {\n            if (this.status.debuffAtkSpe) return\n            this.debuff.debuffAtkSpe =  Math.round(this.debuff.caster.attackSpe * this.debuff.power) / 100\n        }\n    }\n\n    decrementEffect(propretry) {\n      \n        if (this[propretry]?.expireIn > 0) {\n            this[propretry].expireIn -= 1\n\n            if (this[propretry].expireIn === 0) {\n                \n                const expiredEffectName = this[propretry].name\n                this.update({\n                    [propretry]: null\n                })\n                return [\n                    {type:\"textMessage\", text:`${expiredEffectName} est finito`}\n                ]\n            } \n        }\n        \n        return []\n    }\n    decrementStatus() {\n        const expiredEvent = this.statusEffects.reduce((previousEffect, currentEffect) => {\n            if (typeof previousEffect === \"object\") return previousEffect.concat(this.decrementEffect(currentEffect))\n            return this.decrementEffect(previousEffect).concat(this.decrementEffect(currentEffect)) \n        })  \n        return expiredEvent\n\n        \n    }\n\n}"],"names":[],"version":3,"file":"index.d8abab1a.js.map","sourceRoot":"/__parcel_source_root/"}