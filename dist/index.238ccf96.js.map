{"mappings":"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","sources":["Script/OverworldEvent.js"],"sourcesContent":["class OverworldEvent {\n    constructor({map, eventConfig}) {\n        this.map = map\n        this.event = eventConfig\n        this.container = document.querySelector(\".game-container\")\n     \n    }\n\n    stand(resolve) {\n        \n        const who = this.map.gameObject[this.event.who]\n\n        who.startBehavior({\n            map: this.map\n        }, {\n            type: this.event.type,\n            direction: this.event.direction,\n            time: this.event.time\n        })\n\n        const completeHandler = e => {  \n            if (e.detail.whoId === who.id) {\n                document.removeEventListener(\"IFinishStand\", completeHandler)          \n                resolve()\n            }\n        }\n        document.addEventListener(\"IFinishStand\", completeHandler)\n    }\n    //Wall of the Player\n    //Behavior of Npc when he walking\n    walk(resolve) {\n\n        const who = this.map.gameObject[ this.event.who ]\n        console.log(\"who est censé marché\")\n        who.startBehavior({\n            map: this.map\n        }, {\n            type: this.event.type,\n            direction: this.event.direction\n        })      \n\n        const completeHandler = e => {  \n            if (e.detail.whoId === who.id) {              \n                document.removeEventListener(\"IFinishWalk\", completeHandler)    \n                resolve()\n            }\n        }\n        document.addEventListener(\"IFinishWalk\", completeHandler)\n    }\n\n    textMessage(resolve) {\n        if (this.event.faceHero) {\n            const obj = this.map.gameObject[this.event.faceHero]   \n        \n            obj.direction = utils.oppositeDirection(this.map.gameObject[\"hero\"].direction)\n        }\n        const text = this.event.text\n        .replace(\"{playerName}\", playerState.name)\n        const npcName = this.event.who\n        const getPlayerName = this.event.getPlayerName ? true : false\n        const message = new TextMessage({text, npcName, getPlayerName, onComplete: () => {\n            resolve()\n        }})\n        message.init(document.querySelector(\".game-container\"))\n    }\n\n    changeMap(resolve) {\n        const sceneTransition = new SceneTransition()\n        const map = window.overworldMaps[this.event.map]\n        const overworld = this.map.overworld\n        sceneTransition.init(document.querySelector(\".game-container\"), () => {\n            this.map.overworld.startMap(map,{\n                x: this.event.x,\n                y: this.event.y,\n                direction: this.event.direction\n            }, overworld)\n            overworld.map.resetPosition()\n            resolve()   \n            sceneTransition.fadeOut()\n        })\n    }\n\n    battle(resolve) {\n        const ennemyId = window.ennemies[this.event.ennemyId]\n        const battleScene = new Battle({\n            ennemyId,\n            onComplete: (didWin) => {\n                resolve(didWin ? \"WON_BATTLE\" : \"LOST_BATTLE\")\n            }\n        })    \n        battleScene.init(this.container)\n    }\n\n    pause(resolve) {\n        \n        const pauseMenu = new PauseMenu({\n            progress: this.map.overworld.progress,\n            onComplete: () => {\n                resolve()\n            }\n        })\n        pauseMenu.init(this.container)\n        \n    }\n\n    addStoryFlags(resolve) {\n        const cutsceneListener = new CutsceneListener({map: this.map})\n        playerState.storyFlags[this.event.flag] = true\n        playerState.numberFlags += 1\n        resolve()\n        cutsceneListener.listenOnFlag(this.event.flag)\n    }\n\n    craftingMenu(resolve) {\n        const menu = new CraftingMenu({\n            pizzas: this.event.pizzas,\n            onComplete: (didClose) => {\n                resolve(didClose ? \"CLOSED_CRAFT_MENU\" : \"USED_CRAFT_MENU\")\n            }\n        })\n        menu.init(this.container)\n    }\n\n    healTeam(resolve) {\n        playerState.lineup.forEach(id => {\n            const pizza = playerState.pizzas[id]\n            pizza.hp = pizza.maxHp\n        })\n\n        utils.createCustomEvent(\"PlayerStateUpdated\")\n\n        resolve()\n    }\n\n    appearNpc({npcId, x, y}) {\n        const npcData = window.npcData[npcId]\n        this.map.gameObject[npcId] = {\n            ...npcData,\n            x: withGrid(x),\n            y: withGrid(y),\n        }\n    }\n\n    earnMoney(resolve) {\n        const amoutOfMoney = this.event.money  \n        playerState.money += amoutOfMoney\n        utils.createCustomEvent(\"moneyChanged\")\n        resolve()\n    }\n\n    shopMenu(resolve) {\n        \n        const whichShop = this.map.gameObject[this.event.which]\n        whichShop.onComplete = () => {\n            resolve()\n        }\n        whichShop.init(this.map.overworld.element)\n    }\n    init() {\n        \n        return new Promise(resolve => {\n            this[this.event.type](resolve)\n        })\n    }\n}"],"names":[],"version":3,"file":"index.238ccf96.js.map","sourceRoot":"/__parcel_source_root/"}